







ifeq ($(PIC),APIC)
PIC=APIC.o
else
PIC=8259A.o
endif

all: system
	objcopy -I elf64-x86-64 -S -R ".eh_frame" -R ".comment" -O binary system kernel.bin

system:	head.o entry.o APU_boot.o main.o printk.o trap.o memory.o interrupt.o task.o cpu.o keyboard.o mouse.o disk.o SMP.o time.o HPET.o\
				softirq.o timer.o schedule.o

	ld -b elf64-x86-64 -z muldefs -o system $^ $(PIC) -T Kernel.lds 


clean:
	
	$(RM)	 *.o *.s~ *.s *.S~ *.c~ *.h~ system  Makefile~ Kernel.lds~ kernel.bin 